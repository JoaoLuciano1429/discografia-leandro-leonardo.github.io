const explosaoDeDesejos = {
  cover: "img/explosao-de-desejos.jpg",
  title: "Explosão de Desejos",
  year: 1986,
  numberOfTracks: 12,
  folder: "explosao-de-desejos",
  tracks: [
    "01-Contradições.mp3",
    "02-Filme-de-Amor.mp3",
    "03-Explosão-de-Desejos.mp3",
    "04-Eu-Nem-Sei-Existir.mp3",
    "05-Pé-de-Milho.mp3",
    "06-Teatro-da-Vida.mp3",
    "07-Muros-Coloridos.mp3",
    "08-Fui-um-Tolo.mp3",
    "09-Sublime-Renúncia.mp3",
    "10-Relienta.mp3",
    "11-Moça-Bonita-do-Campo.mp3",
    "12-Você-Nasceu-Para-Amar.mp3",
  ],
  color: "#af9c71",
  textColor: "black",
};

const volume2 = {
  cover: "img/volume-2.jpg",
  title: "Leandro & Leonardo Vol. 2",
  year: 1987,
  numberOfTracks: 12,
  folder: "volume-2",
  tracks: [
    "01-Aconchego.mp3",
    "02-Bicho-Do-Paraná.mp3",
    "03-Mesmo-Apesar-Da-Chuva.mp3",
    "04-Fim-De-Comédia.mp3",
    "05-Bem-Te-Vi.mp3",
    "06-Nosso-Amor.mp3",
    "07-Voltei-Pra-Ficar.mp3",
    "08-Solidão.mp3",
    "09-Amor-Nas-Galáxias.mp3",
    "10-Resto-De-Vida.mp3",
    "11-O-Amor-Já-Foi-Embora.mp3",
    "12-Conselho-De-Pai.mp3",
  ],
  color: "#474f44",
  textColor: "white",
};

const volume3 = {
  cover: "img/volume-3.jpg",
  title: "Leandro & Leonardo Vol. 3",
  year: 1989,
  numberOfTracks: 12,
  folder: "volume-3",
  tracks: [
    "01-Quem-Será-Essa-Mulher.mp3",
    "02-Lágrimas-do-Coração.mp3",
    "03-Quebra-Esse-Gelo.mp3",
    "04-Quarto-Negro.mp3",
    "05-Paraíso.mp3",
    "06-É-Por-Você-Que-Canto-(The-Sounds-of-Silence).mp3",
    "07-Aqueles-Olhos.mp3",
    "08-Entre-Tapas-e-Beijos.mp3",
    "09-Teu-Olhar.mp3",
    "10-Cai-na-Real.mp3",
    "11-Semi-Luz.mp3",
    "12-Luar-do-Sertão.mp3",
  ],
  color: "#e2e2f4",
  textColor: "black",
};

const volume4 = {
  cover: "img/volume-4.jpg",
  title: "Leandro & Leonardo Vol. 4",
  year: 1990,
  numberOfTracks: 12,
  folder: "volume-4",
  tracks: [
    "01-Cadê-Você.mp3",
    "02-Talvez-Você-Se-Lembre.mp3",
    "03-O-Cheiro-da-Maçã.mp3",
    "04-Coração-Quer-Te-Encontrar.mp3",
    "05-Mais-Uma-Vez-Sozinho-(Marcas-de-Amor).mp3",
    "06-Pra-Nunca-Dizer-Adeus.mp3",
    "07-Pense-em-Mim.mp3",
    "08-Só-Fazendo-Amor.mp3",
    "09-Você-Ainda-Vai-Voltar.mp3",
    "10-Ponto-Fraco.mp3",
    "11-Desculpe,-Mas-Eu-Vou-Chorar.mp3",
    "12-Talismã.mp3",
  ],
  color: "#526193",
  textColor: "white",
};

const volume5 = {
  cover: "img/volume-5.jpg",
  title: "Leandro & Leonardo Vol. 5",
  year: 1991,
  numberOfTracks: 12,
  folder: "volume-5",
  tracks: [
    "01-Sonho-por-Sonho.mp3",
    "02-Gostoso-Sentimento.mp3",
    "03-Não-Aprendi-a-Dizer-Adeus.mp3",
    "04-Bate-Coração.mp3",
    "05-Sabor-de-Mim.mp3",
    "06-Me-Dê-Um-Sinal.mp3",
    "07-Mensagem.mp3",
    "08-Estou-Na-Mão-Desta-Mulher.mp3",
    "09-A-Rotina-(Fim-de-Semana).mp3",
    "10-Não-Olhe-Assim.mp3",
    "11-Amores-São-Coisas-da-Vida.mp3",
    "12-Paz-na-Cama.mp3",
  ],
  color: "#5e4d82",
  textColor: "white",
};

const volume6 = {
  cover: "img/volume-6.jpg",
  title: "Leandro & Leonardo Vol. 6",
  year: 1992,
  numberOfTracks: 12,
  folder: "volume-6",
  tracks: [
    "01-O-Que-Eu-Sinto-É-Amor.mp3",
    "02-Um-Arraso-de-Mulher.mp3",
    "03-Fim-de-Semana-Sem-Você.mp3",
    "04-Conta-Pra-Ela.mp3",
    "05-Mais-Uma-Noite-Sem-Você.mp3",
    "06-Você-É-Doida-Demais.mp3",
    "07-Não-Durmo-Sem-Ela.mp3",
    "08-Amor-Vampiro.mp3",
    "09-Temporal-de-Amor.mp3",
    "10-Esta-Noite-Foi-Maravilhosa-(Wonderful-Tonight).mp3",
    "11-Vem-Fazer-Amor-Comigo.mp3",
    "12-Chega.mp3",
  ],
  color: "#a68675",
  textColor: "black",
};

const volume7 = {
  cover: "img/volume-7.jpg",
  title: "Leandro & Leonardo Vol. 7",
  year: 1993,
  numberOfTracks: 12,
  folder: "volume-7",
  tracks: [
    "01-Bobo.mp3",
    "02-Mexe-Mexe.mp3",
    "03-Quem-É.mp3",
    "04-Outra-Chance.mp3",
    "05-Seja-Bem-Vinda.mp3",
    "06-Em-Nome-do-Amor.mp3",
    "07-Quero-Ser-o-Seu-Dono.mp3",
    "08-Gosto-Dela.mp3",
    "09-A-Vida-Tem-Dessas-Coisas.mp3",
    "10-Uma-História-Sem-Fim.mp3",
    "11-O-Quanto-Nosso-Amor-Valeu.mp3",
    "12-Diz-Que-Me-Ama.mp3",
  ],
  color: "#ea603d",
  textColor: "white",
};

const volume8 = {
  cover: "img/volume-8.jpg",
  title: "Leandro & Leonardo Vol. 8",
  year: 1994,
  numberOfTracks: 13,
  folder: "volume-8",
  tracks: [
    "01-Mulher-Brasileira.mp3",
    "02-Nao-Sei-Mais-Dormir-Sozinho.mp3",
    "03-25-Horas-por-Dia.mp3",
    "04-Saudades-Dela.mp3",
    "05-Dor-de-Amor-Não-Tem-Jeito.mp3",
    "06-Índia-(Índia).mp3",
    "07-Diga-Pra-Mim-(Philosopher).mp3",
    "08-Casa-Separa.mp3",
    "09-Cavaleiro-do-Asfalto.mp3",
    "10-Brigar-Com-Ele.mp3",
    "11-Dodói-de-Amor.mp3",
    "12-Separados.mp3",
    "13-Achei-Uma-Louca.mp3",
  ],
  color: "#e0d8dc",
  textColor: "black",
};

const volume9 = {
  cover: "img/volume-9.jpg",
  title: "Leandro & Leonardo Vol. 9",
  year: 1995,
  numberOfTracks: 14,
  folder: "volume-9",
  tracks: [
    "01-Eu-Juro-(I-Swear).mp3",
    "02-O-Que-a-Vida-Fez-Comigo.mp3",
    "03-Um-Violeiro-Toca.mp3",
    "04-Entre-Um-Gole-e-Outro.mp3",
    "05-Diz-Pra-Mim.mp3",
    "06-Chuva-de-Lágrimas.mp3",
    "07-Festa-de-Rodeio.mp3",
    "08-Jogo-de-Orgulho.mp3",
    "09-Transa-Comigo.mp3",
    "10-Fui-Dando-Porrada.mp3",
    "11-Animal.mp3",
    "12-Maravilhas-do-Mundo.mp3",
    "13-Tarde-Demais.mp3",
    "14-Viúva-Nova.mp3",
  ],
  color: "#98c1d3",
  textColor: "black",
};

const volume10 = {
  cover: "img/volume-10.jpg",
  title: "Leandro & Leonardo Vol. 10",
  year: 1996,
  numberOfTracks: 15,
  folder: "volume-10",
  tracks: [
    "01-Eu-Sou-Desejo,-Você-é-Paixão-(Right-Here-Waiting).mp3",
    "02-Horizonte-Azul.mp3",
    "03-Touro-de-Rodeio.mp3",
    "04-Sempre-Será.mp3",
    "05-Saudade-Cigana.mp3",
    "06-Devolva-a-Passagem.mp3",
    "07-Pimba.mp3",
    "08-Amor-Antigo.mp3",
    "09-Loucuras-de-Amor.mp3",
    "10-Doce-Mistério.mp3",
    "11-Por-Causa-Dela.mp3",
    "12-O-Lutador-(The-Boxer).mp3",
    "13-Mordida-na-Maçã.mp3",
    "14-É-Nisso-Que-Dá.mp3",
    "15-Secretária-Eletrônica.mp3",
  ],
  color: "#904f49",
  textColor: "white",
};

const volume11 = {
  cover: "img/volume-11.jpg",
  title: "Leandro & Leonardo Vol. 11",
  year: 1997,
  numberOfTracks: 14,
  folder: "volume-11",
  tracks: [
    "01-Essas-Mulheres-(Esas-Mujeres).mp3",
    "02-Cerveja.mp3",
    "03-Foi-Um-Tiro-Em-Minha-Vida.mp3",
    "04-Rumo-à-Goiânia.mp3",
    "05-Se-For-Preciso-Chorar.mp3",
    "06-Anarriê.mp3",
    "07-O-Amor-Que-a-Gente-Faz.mp3",
    "08-Pedindo-Amor.mp3",
    "09-Segura-Peão.mp3",
    "10-História-de-Um-Amor-(História-de-Un-Amor).mp3",
    "11-Cama-Fria.mp3",
    "12-Pode-Ser-Você-Meu-Grande-Amor.mp3",
    "13-Onde-Foi-Que-Eu-Errei.mp3",
    "14-Salva-Minha-Vida.mp3",
  ],
  color: "#d4c79f",
  textColor: "black",
};

const umSonhador = {
  cover: "img/um-sonhador.jpg",
  title: "Um Sonhador",
  year: 1998,
  numberOfTracks: 15,
  folder: "um-sonhador",
  tracks: [
    "01-Deu-Medo.mp3",
    "02-Solidão-Por-Perto.mp3",
    "03-Tô-Querendo-Você.mp3",
    "04-Dia-de-Rodeio.mp3",
    "05-Copo-de-Vinho.mp3",
    "06-Amor-Dividido.mp3",
    "07-Não-Entrego.mp3",
    "08-Cumade-e-Cumpade.mp3",
    "09-Tô-Dando-o-Fora.mp3",
    "10-Machucando-o-Coração.mp3",
    "11-Abandonado-(Abandonada).mp3",
    "12-Vou-Onde-Você-Estiver.mp3",
    "13-Amor-de-Novela.mp3",
    "14-Paixão-de-Rodeio.mp3",
    "15-Um-Sonhador.mp3",
  ],
  color: "#d08831",
  textColor: "white",
};

const body = document.body;
const main = document.querySelector("main");
const aside = document.querySelector("aside");
const footer = document.querySelector("footer");
const albumCover = document.getElementById("albumCover");
const albumTitle = document.getElementById("albumTitle");
const albumYear = document.getElementById("year");
const playlist = document.getElementById("playlist");
const spanFooter = document.querySelector("footer span");
const divFooter = document.querySelector("footer div");
const loopBtn = document.getElementById("loop");
const randomBtn = document.getElementById("random");

let currentAlbum = null;
let currentTrackIndex = null;
let isLoopAll = false;
let isLoopOne = false;
let isShuffle = false;
let shuffledIndexes = [];
let shufflePointer = 0;

function displayAlbum(albumKey) {
  const album = albumKey;

  albumCover.src = albumKey.cover;
  albumTitle.innerText = albumKey.title;
  albumYear.innerText = albumKey.year;

  body.style.backgroundImage = `url("${albumKey.cover}")`;
  body.style.color = albumKey.textColor;
  main.style.backgroundColor = albumKey.color;
  main.style.color = albumKey.textColor;
  aside.style.backgroundColor = albumKey.color;
  aside.style.color = albumKey.textColor;
  footer.style.backgroundColor = albumKey.color;
  playlist.innerHTML = ""; // Limpa a lista de músicas
  spanFooter.style.borderColor = albumKey.textColor;
  divFooter.style.borderColor = albumKey.textColor;

  album.tracks.forEach((track, index) => {
    const li = document.createElement("li");
    li.innerText = track.replace(/^\d+-/, "").replace(/\.mp3$/, ""); // Remove números e extensão para exibir o título
    li.addEventListener("click", () => playTrack(albumKey, index)); // Adiciona evento de clique
    playlist.appendChild(li);
  });
}

document
  .getElementById("alb1")
  .addEventListener("click", () => displayAlbum(explosaoDeDesejos));

document
  .getElementById("alb2")
  .addEventListener("click", () => displayAlbum(volume2));

document
  .getElementById("alb3")
  .addEventListener("click", () => displayAlbum(volume3));

document
  .getElementById("alb4")
  .addEventListener("click", () => displayAlbum(volume4));

document
  .getElementById("alb5")
  .addEventListener("click", () => displayAlbum(volume5));

document
  .getElementById("alb6")
  .addEventListener("click", () => displayAlbum(volume6));

document
  .getElementById("alb7")
  .addEventListener("click", () => displayAlbum(volume7));

document
  .getElementById("alb8")
  .addEventListener("click", () => displayAlbum(volume8));

document
  .getElementById("alb9")
  .addEventListener("click", () => displayAlbum(volume9));

document
  .getElementById("alb10")
  .addEventListener("click", () => displayAlbum(volume10));

document
  .getElementById("alb11")
  .addEventListener("click", () => displayAlbum(volume11));

document
  .getElementById("alb12")
  .addEventListener("click", () => displayAlbum(umSonhador));

const player = document.getElementById("player");

function playTrack(albumKey, trackIndex) {
  const album = albumKey;
  const track = album.tracks[trackIndex];
  const trackPath = `audio/${album.folder}/${track}`;

  player.src = trackPath;
  player.play();

  currentAlbum = albumKey;
  currentTrackIndex = trackIndex;

  // Atualiza ponteiro do shuffle se necessário
  if (isShuffle && shuffledIndexes.length > 0) {
    shufflePointer = shuffledIndexes.indexOf(trackIndex);
  }
}

player.addEventListener("contextmenu", function (e) {
  e.preventDefault();
});

// Função para tocar a próxima música, considerando o modo de repetição e aleatório
function playNextTrack() {
  if (!currentAlbum || currentTrackIndex === null) return;

  if (isShuffle) {
    shufflePointer++;
    if (shufflePointer >= shuffledIndexes.length) {
      if (isLoopAll) {
        shuffleArray(shuffledIndexes);
        shufflePointer = 0;
      } else {
        return; // Fim da lista aleatória
      }
    }
    playTrack(currentAlbum, shuffledIndexes[shufflePointer]);
  } else {
    let nextIndex = currentTrackIndex + 1;
    if (nextIndex >= currentAlbum.tracks.length) {
      if (isLoopAll) {
        nextIndex = 0;
      } else {
        return; // Fim do álbum
      }
    }
    playTrack(currentAlbum, nextIndex);
  }
}

// Função para tocar a música anterior, considerando o modo de repetição e aleatório
function playPreviousTrack() {
  if (!currentAlbum || currentTrackIndex === null) return;

  if (isShuffle) {
    shufflePointer--;
    if (shufflePointer < 0) {
      if (isLoopAll) {
        shufflePointer = shuffledIndexes.length - 1;
      } else {
        return;
      }
    }
    playTrack(currentAlbum, shuffledIndexes[shufflePointer]);
  } else {
    let prevIndex = currentTrackIndex - 1;
    if (prevIndex < 0) {
      if (isLoopAll) {
        prevIndex = currentAlbum.tracks.length - 1;
      } else {
        return;
      }
    }
    playTrack(currentAlbum, prevIndex);
  }
}

// Eventos dos botões
document.getElementById("next").addEventListener("click", playNextTrack);
document
  .getElementById("previous")
  .addEventListener("click", playPreviousTrack);

// Atualiza o emoji do botão de loop
function updateLoopButton() {
  if (isLoopOne) {
    loopBtn.textContent = "🔂"; // Repetir faixa
    loopBtn.title = "Repetir faixa";
  } else if (isLoopAll) {
    loopBtn.textContent = "🔁"; // Repetir álbum
    loopBtn.title = "Repetir álbum";
  } else {
    loopBtn.textContent = "🔶"; // Sem repetição
    loopBtn.title = "Sem repetição";
  }
}

// Atualiza o visual do botão de aleatório
function updateRandomButton() {
  if (isShuffle) {
    randomBtn.style.border = "2px solid #2ecc40"; // Borda verde
    randomBtn.title = "Ordem aleatória ativada";
  } else {
    randomBtn.style.border = "none";
    randomBtn.title = "Ordem aleatória desativada";
  }
}

// Alterna o modo de repetição: nenhum -> álbum -> faixa -> nenhum...
loopBtn.addEventListener("click", () => {
  if (!isLoopAll && !isLoopOne) {
    isLoopAll = true;
    isLoopOne = false;
  } else if (isLoopAll && !isLoopOne) {
    isLoopAll = false;
    isLoopOne = true;
  } else {
    isLoopAll = false;
    isLoopOne = false;
  }
  updateLoopButton();
});

randomBtn.addEventListener("click", () => {
  isShuffle = !isShuffle;
  updateRandomButton();
  if (isShuffle && currentAlbum) {
    // Gera uma nova ordem aleatória
    shuffledIndexes = Array.from(
      { length: currentAlbum.tracks.length },
      (_, i) => i
    );
    shufflePointer = 0;
    shuffleArray(shuffledIndexes);
    // Se já tem uma música tocando, posiciona o ponteiro nela
    if (currentTrackIndex !== null) {
      shufflePointer = shuffledIndexes.indexOf(currentTrackIndex);
    }
  }
});

// Função para embaralhar um array (Fisher-Yates)
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Evento de fim de faixa
player.addEventListener("ended", () => {
  if (isLoopOne) {
    playTrack(currentAlbum, currentTrackIndex); // Repete a faixa
  } else {
    playNextTrack();
  }
});

// Atualiza botões ao carregar a página
updateLoopButton();
updateRandomButton();

// ...existing code...
